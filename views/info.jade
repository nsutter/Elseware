extends layout

block content
  
  .container
    .row
      .col-md-6.pull-right
        section#zone_chat
      
        form#newMessage(action='/', method='post')
          .col-md-10.col-sm-10.col-xs-8.pull-left
            input.form-control(type='text', name='message', id='message', placeholder='Your message')
          .col-md-1.col-sm-1.col-xs-1.pull-left
            .input-group-btn
              .form-group
                button.btn.btn-default(type='submit')
                  | Send
    
  script(src='https://cdn.socket.io/socket.io-1.3.7.js')
  script.
    var socket = io.connect('http://localhost:3001');
    var pseudo = prompt('Quel est votre pseudo ?');
    var room =  !{JSON.stringify(data._id)};
    
    socket.emit('nouveau_client', pseudo, room);
    
    
    socket.on('message', function(data) {
              insereMessage(data.pseudoem, data.message);
          })

    $('#newMessage').submit(function () {
                  var message = $('#message').val();
                  socket.emit('message', message, pseudo, room); // Transmet le message aux autres
                  insereMessage(pseudo, message);
                  $('#message').val('').focus(); // Vide la zone de Chat et remet le focus dessus
                  return false; // Permet de bloquer l'envoi "classique" du formulaire
              });
              
    socket.on('nouveau_client', function(pseudo) {
          $('#zone_chat').prepend('<p><em>' + pseudo + ' a rejoint le Chat !</em></p>');
        })

    function insereMessage(pseudoem, message) {
              $('#zone_chat').append('<p><strong>' + pseudoem + '</strong> :' + message + '</p>');
          }
    function inseretexte(texte) {
              $('#zone_chat').append('<p>' + texte + '</p>');
          }
